
library(readxl)
library(dplyr)

DATABASES <- file.path('/', 'home', 'databases')

# import
cargar_ciuo <- function() {
  file.path(DATABASES, 'codigueras', 'ciuo', 'listado_a_usar_Ocupaciones.xls') %>% 
    read_excel(skip = 1, col_names = TRUE) %>% rename_at(1:4, ~c("denominacion_ocupaciones", "cnuo_95", "descripcion", "ciuo"))
}


codiguera_ciuo <- function() {
  cargar_ciuo() %>% 
    transmute(ciuo, descripcion) %>% 
    mutate(descripcion = case_when(ciuo == "1412" ~ "Gerentes de restaurantes",
                                   ciuo == "1431" ~ "Gerentes de centros deportivos, de esparcimiento y culturales",
                                   TRUE ~ descripcion)) %>% 
    unique
}

# Listado de grandes grupos (LISTADO NACIONAL DE DENOMINACIONES DE OCUPACIONES (CIUO).pdf)
grupos_ciuo <- tribble(
  ~grupo,   ~descripcion.grupo,
  "0",      "Ocupaciones militares",
  "1",      "Directores y gerentes",
  "2",      "Profesionales científicos e intelectuales",
  "3",      "Técnicos y profesionales de nivel medio",
  "4",      "Personal de apoyo administrativo",
  "5",      "Trabajadores de los servicios y vendedores de comercios y mercados",
  "6",      "Agricultores y trabajadores calificados agropecuarios, forestales y pesqueros",
  "7",      "Oficiales, operarios y artesanos de artes mecánicas y de otros oficios",
  "8",      "Operadores de instalaciones y máquinas y ensambladores",
  "9",      "Ocupaciones elementales"
)

  